<div class="rc-classes">
  <div class="py-2 d-flex">
    <span class="h3">Classes</span>
    <span class="spacer"></span>
    <span class="px-2">
      <button (click)="saveClassAction()" class="p-button-rounded" icon="pi pi-plus-circle" pButton></button>
    </span>
    <span class="px-2">
      <button (click)="loadClasses()" class="p-button-rounded" icon="pi pi-refresh" pButton type="button"></button>
    </span>
  </div>

  <div class="py-2">
    <div class="container-fluid">
      <div class="row py-2">
        <div class="form-group row">
          <div class="col-8">
            <p-dropdown [options]="sections"  [optionLabel]="'name'" [optionValue]="'id'" (onChange)="loadClasses()"
                        [placeholder]="'Select School Section'" [(ngModel)]="sectionId" [styleClass]="'w-100'"></p-dropdown>
          </div>
          <div class="col-4">
            <button (click)="loadClasses()" class="" pButton>Load Classes</button>
          </div>
        </div>
      </div>
      <div *ngIf="classes.length == 0" class="row py-2">
        <span class="text-center">No classes for this section</span>
      </div>
      <div *ngIf="classes.length != 0" class="">
        <p-panel [header]="c.classLevel.name" [toggleable]="true" *ngFor="let c of classes">
          <ng-template pTemplate="icons">
            <button pButton class="p-panel-header-icon p-link" icon="pi pi-plus"></button>
            <button pButton class="p-panel-header-icon p-link" icon="pi pi-pencil" [routerLink]="['/dashboard/class/view', 1]"></button>
            <button pButton class="p-panel-header-icon p-link" icon="pi pi-trash" (click)="deleteClassAction(c.classLevel)"></button>
          </ng-template>
          <ng-template pTemplate="body">
            <div class="grid">
              <div class="col-3 py-3" *ngFor="let classLevelSub of c.classLevelSubs">
                <p-card header="{{classLevelSub.name}}" styleClass="p-card-shadow p-1 block">
                  <span class="block">Full Name: {{c.classLevel.name}} {{classLevelSub.name}}</span>
                  <span class="block">
                    Number of students applied: {{classLevelSub.numberOfStudents ? classLevelSub.numberOfStudents : 0}}
                  </span>
                  <div class="py-2">
                    <button (click)="deleteClassSubAction(classLevelSub.id, c.classLevel)" pButton icon="pi pi-trash" class="p-button-danger"></button>
                  </div>
                  <!-- TODO fetch this data from backend -->
                </p-card>
              </div>
            </div>
            <div class="flex px-3">
              <input pInputText class="" #classSubNameInput>&nbsp;
              <button (click)="addClassLevelSubAction(c.classLevel.id, classSubNameInput.value)" pButton [disabled]="classSubNameInput.value == ''" class="p-button-plain" label="Add" icon="pi pi-plus"></button>
            </div>
          </ng-template>
        </p-panel>
      </div>
    </div>
  </div>
</div>
